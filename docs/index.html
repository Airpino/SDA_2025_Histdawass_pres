<!DOCTYPE html>
<html lang="en"><head>
<script src="pre_new_files/libs/clipboard/clipboard.min.js"></script>
<script src="pre_new_files/libs/quarto-html/tabby.min.js"></script>
<script src="pre_new_files/libs/quarto-html/popper.min.js"></script>
<script src="pre_new_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="pre_new_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="pre_new_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="pre_new_files/libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Antonio Irpino">
  <meta name="dcterms.date" content="2025-06-09">
  <title>The HistDAWass package:   A package for the analysis of Histogram-valued data</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="pre_new_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="pre_new_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="pre_new_files/libs/revealjs/dist/theme/quarto-00033b64c7f4405b1251d0bf85080562.css">
  <link rel="stylesheet" href="custom-style.css">
  <link href="pre_new_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="pre_new_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="pre_new_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="pre_new_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="sda_logo.png" data-background-position="top left" data-background-size="100px" data-footer="Workshop on SDA – Varaždin, Croatia – June 9–11, 2025" class="quarto-title-block center">
  <h1 class="title"><p>The <code>HistDAWass</code> package: <br> A package for the analysis of Histogram-valued data</p></h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Antonio Irpino 
</div>
<div class="quarto-title-author-email">
<a href="mailto:antonio.irpino@unicampania.it">antonio.irpino@unicampania.it</a>
</div>
        <p class="quarto-title-affiliation">
            Department of Mathematics and Physics <br> University of Campania L. Vanvitelli <br> Caserta, Italy
          </p>
    </div>
</div>

  <p class="date">June 9, 2025</p>
</section>
<section id="outline" class="slide level2">
<h2>Outline</h2>
<ul>
<li>The package and how to install it</li>
<li>Main classes and methods</li>
<li>From raw data to histograms</li>
<li>Histogram-valued data table</li>
<li>Distances for histogram-valued data: the <span class="math inline">\(L_2\)</span> Wasserstein distance</li>
<li>Basic univariate statistics for histogram variables</li>
<li>Association measure for histogram variables</li>
</ul>
</section>
<section id="histdawass-package" class="slide level2">
<h2>HistDAWass Package</h2>
<ul>
<li><strong>Hist</strong>ogram</li>
<li><strong>D</strong>ata</li>
<li><strong>A</strong>nalysis</li>
<li>using <strong>Wass</strong>erstein distance</li>
</ul>
<p>The package can be downloaded from CRAN and loaded as usually(in R):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"HistDAWass"</span>)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"HistDAWass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="classes-of-histdawass" class="slide level2">
<h2>Classes of <code>HistDAWass</code></h2>
<h4 id="object-oriented-design-with-s4">Object-Oriented Design with S4</h4>
<p>The <code>HistDAWass</code> package defines its core classes and methods using the <strong>S4 object-oriented system</strong> in R.<br>
This provides a more rigorous and structured approach to object-oriented programming compared to S3.</p>
<h4 id="main-classes-in-the-package">Main Classes in the Package</h4>
<ul>
<li><strong><code>distributionH</code></strong> – Represents a single histogram-valued datum (HD).</li>
<li><strong><code>MatH</code></strong> – A matrix (or data table) of histogram-valued data.</li>
<li><strong><code>TdistributionH</code></strong> – A histogram-valued datum with a timestamp or time interval (for time series).</li>
<li><strong><code>TMatH</code></strong> – A matrix of timestamped histogram-valued data.</li>
<li><strong><code>HTS</code></strong> – A Histogram Time Series (an ordered list of <code>TdistributionH</code> objects).</li>
</ul>
</section>
<section id="the-distributionh-class-representing-a-1d-histogram" class="slide level2">
<h2>The <code>distributionH</code> Class: Representing a 1D Histogram</h2>
<p>We want to create a new <code>distributionH</code> object that encodes the following histogram:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th><strong>Bin</strong></th>
<th><strong>Rel. Freq.</strong></th>
<th><strong>CDF</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[1; 2)</td>
<td>0.4</td>
<td>0.4</td>
</tr>
<tr class="even">
<td>(2; 3]</td>
<td>0.6</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a>mydist<span class="ot">=</span><span class="fu">distributionH</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb2-2"><a href="" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>, <span class="dv">1</span>))</span>
<span id="cb2-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Formal class 'distributionH' [package "HistDAWass"] with 4 slots
  ..@ x: num [1:3] 1 2 3
  ..@ p: num [1:3] 0 0.4 1
  ..@ m: num 2.1
  ..@ s: num 0.569</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Show function</span></span>
<span id="cb4-2"><a href="" aria-hidden="true" tabindex="-1"></a>mydist </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          X         p
Bin_1 [ 1 ; 2 )       0.4
Bin_2 [ 2 ; 3 ]       0.6

 mean =  2.1   std  =  0.568624070307733 
 </code></pre>
</div>
</div>
</div></div>
</section>
<section id="plot-functions" class="slide level2">
<h2>Plot functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a>mydist<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="font-size: 1.1em">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Default visualization</span></span>
<span id="cb7-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mydist) #plots mydist</span></span>
<span id="cb7-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"HISTO"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">border=</span><span class="st">"blue"</span>)</span>
<span id="cb7-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#plots a density approximation for mydist</span></span>
<span id="cb7-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"DENS"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">border=</span><span class="st">"blue"</span>) </span>
<span id="cb7-7"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#plots a horizontal boxplot for mydist</span></span>
<span id="cb7-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"HBOXPLOT"</span>) </span>
<span id="cb7-10"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#plots a vertical boxplot for mydist</span></span>
<span id="cb7-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"VBOXPLOT"</span>) </span>
<span id="cb7-13"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#plots the cumulative distr. function of mydist</span></span>
<span id="cb7-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"CDF"</span>) </span>
<span id="cb7-16"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#plots the quantile function of mydist</span></span>
<span id="cb7-18"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mydist, <span class="at">type=</span><span class="st">"QF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="pre_new_files/figure-revealjs/plots_of_distributions2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="obtaining-the-histogram-and-the-cdf-quantiles-and-probabilities-of-a-distributionh-object" class="slide level2">
<h2>Obtaining the histogram and the CDF, quantiles and probabilities of a distributionH object</h2>
<div class="columns">
<div class="column">
<h4 id="distribution-and-cdf"><span style="color: yellow;">Distribution and CDF</span></h4>
<div style="font-size: 1.2em">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># the histogram</span></span>
<span id="cb8-2"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.histo<span class="ot">&lt;-</span><span class="fu">get.histo</span>(mydist)</span>
<span id="cb8-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># the CDF</span></span>
<span id="cb8-4"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.cdf<span class="ot">&lt;-</span><span class="fu">get.distr</span>(mydist) </span>
<span id="cb8-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#into data.frame objects</span></span>
<span id="cb8-6"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.histo</span>
<span id="cb8-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##   min.x max.x   p</span></span>
<span id="cb8-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     7     8 0.2</span></span>
<span id="cb8-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     8    10 0.5</span></span>
<span id="cb8-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    10    15 0.3</span></span>
<span id="cb8-11"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.cdf</span>
<span id="cb8-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##    x   p</span></span>
<span id="cb8-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  7 0.0</span></span>
<span id="cb8-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  8 0.2</span></span>
<span id="cb8-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 10 0.7</span></span>
<span id="cb8-16"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 15 1.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column">
<h4 id="quantiles-or-a-probabilities"><span style="color: yellow;">Quantiles or a probabilities </span></h4>
<div style="font-size: 1.3em">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># computes the CDF value for x=9.5</span></span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">compP</span>(<span class="at">object =</span> mydist,<span class="at">q =</span> <span class="fl">9.5</span>)</span>
<span id="cb9-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.575</span></span>
<span id="cb9-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># computes the quantile  for p=0.1</span></span>
<span id="cb9-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">compQ</span>(<span class="at">object =</span> mydist,<span class="at">p =</span> <span class="fl">0.1</span>) </span>
<span id="cb9-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div></div>
</section>
<section id="other-basic-statistics-for-distributionh-objects" class="slide level2">
<h2>Other basic statistics for distributionH objects</h2>
<div style="font-size: 1.4em">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.mean <span class="ot">&lt;-</span> <span class="fu">meanH</span>(mydist) <span class="co">#computes the mean</span></span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.std <span class="ot">&lt;-</span> <span class="fu">stdH</span>(mydist) <span class="co">#computes the standard deviation</span></span>
<span id="cb10-3"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.skew <span class="ot">&lt;-</span> <span class="fu">skewH</span>(mydist) <span class="co">#computes the 3rd stand. centr. moment</span></span>
<span id="cb10-4"><a href="" aria-hidden="true" tabindex="-1"></a>mydist.kurt <span class="ot">&lt;-</span> <span class="fu">kurtH</span>(mydist) <span class="co">#computes the 4th stand. centr. moment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div style="font-size: 0.7em">
<p>Being <span class="math inline">\(Q(p)\)</span> a quantile function the four measures are, respectively, the histogram version of the following formulas <span class="citation" data-cites="Gilch2000">(<a href="#/references" role="doc-biblioref" onclick="">Gilchrist 2000</a>)</span>:<br>
</p>
<div class="columns">
<div class="column">
<p><span class="math display">\[\mu=\int\limits_0^1Q(p)dp,\]</span> <span class="math display">\[\sigma=\sqrt{\int\limits_0^1Q(p)^2dp-\mu^2},\]</span></p>
</div><div class="column">
<p><span class="math display">\[sk=\left[ \int\limits_0^1\left(\frac{Q(p)-\mu}{\sigma}\right)^3dp\right]^{1/3}\]</span> <span class="math display">\[ku=\left[\int\limits_0^1\left(\frac{Q(p)-\mu}{\sigma}\right)^4dp\right]^{1/4}.\]</span></p>
</div></div>
</div>
</section>
<section id="l_2-wasserstein-distance-between-distributionh-objects" class="slide level2">
<h2><span class="math inline">\(L_2\)</span> Wasserstein distance between distributionH objects</h2>
<div style="font-size: 0.75em">
<p>Given two distributions having <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> as s and, respectively, <span class="math inline">\(Q_f(p)\)</span> and <span class="math inline">\(Q_g(p)\)</span> as quantile functions, the (squared) <span class="math inline">\(L_2\)</span> Wasserstein distance is: <span class="math display">\[d_W^2(f,g)=\int\limits_0^1\left[Q_f(p)-Q_g(p)\right]^2dp\]</span> <span class="citation" data-cites="DBLP:conf/f-egc/2007">(<a href="#/references" role="doc-biblioref" onclick="">Irpino and Romano 2007</a>)</span> and <span class="citation" data-cites="IrpVer2015">(<a href="#/references" role="doc-biblioref" onclick="">Irpino and Verde 2015</a>)</span> showed that <span class="math display">\[d_W^2(f,g)=\left(\mu_f-\mu_g\right)^2+\left(\sigma_f-\sigma_g\right)^2+2\sigma_f\sigma_g\left[1-\rho_{QQ}(f,g)\right]\]</span> where <span class="math inline">\(\rho_{QQ}(f,g)\)</span> is the Pearson correlation between two s: <span class="math display">\[\rho_{QQ}(f,s)=\frac{\int\limits_0^1Q_f(p)Q_g(p)dp-\mu_f\mu_g}{\sigma_f\sigma_g} \]</span></p>
</div>
</section>
<section id="computing-the-dot-product-between-two-quantile-functions-of-histograms" class="slide level2">
<h2>Computing the dot product between two quantile functions of histograms</h2>
<p>If two histograms <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> have a same number of bins, say <span class="math inline">\(k\)</span>, and such bins contain respectively the same mass, namely, <span class="math inline">\(\pi_{\ell,1}=\pi_{\ell,2}\)</span> <span class="math inline">\(\forall \ell \in k\)</span> the dot product can be computed using the histogram trick as follows: <span class="math display">\[\int\limits_0^1Q_f(p)Q_g(p)dp=\sum\limits_{\ell=1}^k\left( c_{\ell,1}c_{\ell,2}+\frac{1}{3}r_{\ell,1}r_{\ell,2}\right)\]</span></p>
<h3 id="how-to-recode-two-hstograms-such-that-thay-have-the-same-number-of-bins-and-the-same-masses">How to recode two hstograms such that thay have the same number of bins and the same masses?</h3>
</section>
<section id="the-register-method-in-action" class="slide level2">
<h2>The <code>register</code> method in action</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>registered <span class="ot">&lt;-</span> <span class="fu">register</span>(dist1, dist2) </span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#returns a list with 2 registered distributionH objects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a> dist1 <span class="ot">&lt;-</span> <span class="fu">distributionH</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="dv">1</span>))</span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a> dist2 <span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">15</span>), <span class="at">p=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="dv">1</span>))</span>
<span id="cb12-3"><a href="" aria-hidden="true" tabindex="-1"></a> dist1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          X         p
Bin_1 [ 1 ; 2 )       0.4
Bin_2 [ 2 ; 3 ]       0.6

 mean =  2.1   std  =  0.568624070307733 
 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a> dist2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            X           p
Bin_1   [ 7 ; 8 )         0.2
Bin_2  [ 8 ; 10 )         0.5
Bin_3 [ 10 ; 15 ]         0.3

 mean =  9.75   std  =  2.09065380523255 
 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a> <span class="do">## register the two distributions</span></span>
<span id="cb16-2"><a href="" aria-hidden="true" tabindex="-1"></a> registered <span class="ot">&lt;-</span><span class="fu">register</span>(dist1,dist2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<p><img data-src="figures/Rplot02.svg" style="width:100.0%"></p>
</div></div>
</section>
<section id="back-to-l_2-wasserstein-distance" class="slide level2">
<h2>Back to <span class="math inline">\(L_2\)</span> Wasserstein distance</h2>
<p>Using <code>register</code> method, the (Squared) <span class="math inline">\(L_2\)</span> Wasserstein distance between two histograms exactly: <span class="math display">\[d_W^2(f,g)=\underbrace{\left(\mu_f-\mu_g\right)^2}_{Position}+\underbrace{\underbrace{\left(\sigma_f-\sigma_g\right)^2}_{Size}+\underbrace{2\sigma_f\sigma_g\left[1-\rho_{QQ}(f,g)\right]}_{Shape}}_{Variability}\]</span></p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Squared 2W distance</span></span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WassSqDistH</span>(dist1,dist2) <span class="co">#computes the squared L2 Wass. dist.</span></span>
<span id="cb17-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Components of the sq. distance too</span></span>
<span id="cb17-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WassSqDistH</span>(dist1,dist2,<span class="at">details=</span><span class="cn">TRUE</span>) <span class="co">#computes with details</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell">
<pre><code>## [1] "No details"
## [1] 61.03667
## [1] "With details"
##  SQ_W_dist   POSITION       SIZE      SHAPE        rQQ 
## 61.0366667 58.5225000  2.3165745  0.1975922  0.9168940</code></pre>
</div>
</div></div>
</section>
<section>
<section id="the-math-class-a-histogram-valued-data-table" class="title-slide slide level1 center">
<h1>The <code>MatH</code> class: a histogram-valued data table</h1>

</section>
<section id="a-data-table-of-hd-the-math-object" class="slide level2">
<h2>A data table of HD: the <code>MatH</code> object</h2>
<div class="columns">
<div class="column">
<p>A <code>MatH</code> object is a table (a matrix): each row is an individual each column is a histogram variable.</p>
<p>In the package are contained some histogram datasets. One of the most known is the <code>BLOOD</code> dataset, containing 14 typologies of patients of an hospital and observed on three variables (Cholesterol, Hemoglobin, Hematocrit).</p>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BLOOD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img data-src="figures/BLOOD_histo.png"></p>
</div></div>
</section>
<section id="the-math-class-and-its-initialization" class="slide level2">
<h2>The <code>MatH</code> class and its initialization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">MatH</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="fu">new</span>(<span class="st">"distributionH"</span>)), <span class="at">nrows =</span> <span class="dv">1</span>, <span class="at">ncols =</span> <span class="dv">1</span>,</span>
<span id="cb20-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">NULL</span>, <span class="at">varnames =</span> <span class="cn">NULL</span>, <span class="at">by.row =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>x</code> is a list of <code>distributionH</code> objects</li>
<li><code>nrows</code> is the number of rows (the individuals)</li>
<li><code>ncols</code> is the number of columns (the variables)</li>
<li><code>rownames</code> is a vector of strings with the labels of the individuals</li>
<li><code>varnames</code> is a vector of strings with the labels of variables</li>
<li><code>by.row</code> indicates if the matrix must be filled by row (TRUE) or by column (FALSE this is the default)</li>
</ul>
</section>
<section id="an-example-of-creation-of-a-new-math-object" class="slide level2">
<h2>An example of creation of a new <code>MatH</code> object</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##---- create a list of six distributionH objects</span></span>
<span id="cb21-2"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="st">"list"</span>,<span class="dv">6</span>)</span>
<span id="cb21-3"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb21-4"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="dv">1</span>))</span>
<span id="cb21-5"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">2</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">15</span>),</span>
<span id="cb21-6"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="dv">1</span>))</span>
<span id="cb21-7"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">3</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">20</span>),</span>
<span id="cb21-8"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span>
<span id="cb21-9"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">4</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>),</span>
<span id="cb21-10"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">1</span>))</span>
<span id="cb21-11"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">5</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">15</span>),</span>
<span id="cb21-12"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>,  <span class="fl">0.75</span>, <span class="dv">1</span>))</span>
<span id="cb21-13"><a href="" aria-hidden="true" tabindex="-1"></a>ListOfDist[[<span class="dv">6</span>]]<span class="ot">&lt;-</span><span class="fu">distributionH</span>(<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">24</span>),</span>
<span id="cb21-14"><a href="" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.12</span>, <span class="dv">1</span>))</span>
<span id="cb21-15"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## create a MatH object filling it by columns</span></span>
<span id="cb21-17"><a href="" aria-hidden="true" tabindex="-1"></a>MyMAT <span class="ot">&lt;-</span> <span class="fu">MatH</span>(<span class="at">x=</span>ListOfDist,<span class="at">nrows=</span><span class="dv">3</span>,<span class="at">ncols=</span><span class="dv">2</span>,</span>
<span id="cb21-18"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames=</span><span class="fu">c</span>(<span class="st">"I1"</span>,<span class="st">"I2"</span>,<span class="st">"I3"</span>), <span class="at">varnames=</span><span class="fu">c</span>(<span class="st">"Var1"</span>,<span class="st">"Var2"</span>),</span>
<span id="cb21-19"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.row=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-20"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co">#bulding an empty 10 by 4 matrix of histograms</span></span>
<span id="cb21-22"><a href="" aria-hidden="true" tabindex="-1"></a>empty.MAT <span class="ot">&lt;-</span> <span class="fu">MatH</span>(<span class="at">nrows=</span><span class="dv">10</span>,<span class="at">ncols=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<h3 id="show-and-plot-method"><code>show</code> and <code>plot</code> method</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(MyMAT) <span class="co">#or simply type MyMAT</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a matrix of distributions 
 2  variables  3  rows 
 each distibution in the cell is represented by the mean and the standard deviation 
              Var1                     Var2          
I1  [m= 2.1  ,s= 0.56862 ]   [m= 5.6  ,s= 1.6248 ]  
I2  [m= 9.75  ,s= 2.0907 ]  [m= 9.875  ,s= 1.7515 ] 
I3 [m= 12.75  ,s= 3.3323 ]  [m= 22.76  ,s= 0.86933 ]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MyMAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img data-src="figures/MyMAT.png"></p>
</div></div>
</section>
<section id="more-on-ploting-a-math-13-basic-plot" class="slide level2">
<h2>More on <code>plot</code>ing a <code>MatH</code> (1/3): basic plot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BLOOD, <span class="at">type=</span><span class="st">"HISTO"</span>,  <span class="at">border=</span><span class="st">"blue"</span>) <span class="co">#plots a matrix of histograms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="figures/BLOOD1.png" class="r-stretch"></section>
<section id="more-on-plotting-a-math-23-density-plot" class="slide level2">
<h2>More on <code>plot</code>ting a <code>MatH</code> (2/3): density plot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(BLOOD, <span class="at">type=</span><span class="st">"DENS"</span>,  <span class="at">border=</span><span class="st">"blue"</span>) <span class="co">#plots a matrix of densities</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="figures/BLOOD2.png" class="r-stretch"></section>
<section id="more-on-plotting-a-math-33-boxplots" class="slide level2">
<h2>More on <code>plot</code>ting a <code>MatH</code> (3/3): boxplots</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(BLOOD, <span class="at">type=</span><span class="st">"BOXPLOT"</span>) <span class="co">#plots a  boxplots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="figures/BLOOD3.png" class="r-stretch"></section>
<section id="main-methods-for-the-math-class" class="slide level2">
<h2>Main methods for the <code>MatH</code> class</h2>
<h3 id="for-accessing-to-some-basic-information">For accessing to some basic information</h3>
<ul>
<li><code>get.MatH.ncols</code> returns the number of columns<br>
</li>
<li><code>get.MatH.nrows</code> returns the number of rows<br>
</li>
<li><code>get.MatH.rownames</code> returns the list of the row-labels</li>
<li><code>get.MatH.varnames</code> return the list of labels of thevariables (the columns)</li>
<li><code>get.MatH.stats</code> return a matrix of a basic statistic computed for each cell of the matrix (some examples follow).</li>
</ul>
</section>
<section id="an-example-of-get.math.stats-method" class="slide level2">
<h2>An example of <code>get.MatH.stats</code> method</h2>
<p>The <code>get.MatH.stats</code> returns a list containing the name of the basic statistics computed and a <code>$mat</code> containing a matrix of numbers with the same dimensions of the <code>MatH</code> object</p>
<h3 id="section"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD) <span class="co"># the means of the distributions in BLOOD dataset </span></span>
<span id="cb28-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'median'</span>) <span class="co"># the medians of the distributions</span></span>
<span id="cb28-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'quantile'</span>, <span class="at">prob=</span><span class="fl">0.5</span>) <span class="co">#the same as median</span></span>
<span id="cb28-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'min'</span>) <span class="co"># minima of the distributions </span></span>
<span id="cb28-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'quantile'</span>, <span class="at">prob=</span><span class="dv">0</span>) <span class="co">#the same as min</span></span>
<span id="cb28-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'max'</span>) <span class="co"># maxima of the distributions </span></span>
<span id="cb28-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'quantile'</span>, <span class="at">prob=</span><span class="dv">1</span>) <span class="co">#the same as max</span></span>
<span id="cb28-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'std'</span>) <span class="co"># standard deviations </span></span>
<span id="cb28-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'skewness'</span>) <span class="co">#skewness indices</span></span>
<span id="cb28-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'kurtosis'</span>) <span class="co">#kurtosis indices</span></span>
<span id="cb28-11"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">get.MatH.stats</span>(BLOOD,<span class="at">stat=</span><span class="st">'quantile'</span>,<span class="at">prob=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="functions-useful-for-maniulating" class="slide level2">
<h2>Functions useful for maniulating</h2>
<h3 id="useful-for-the-histogram-trick">Useful for the histogram trick</h3>
<ul>
<li><code>registerMH(MyMat)</code>, returns a new <code>MatH</code> object with all the distributions transformed. All the distributions have the same number of bins each one containing the same mass (It is useful for computing exactly the basic statistics based on <span class="math inline">\(L_2\)</span> Wasserstein metric)</li>
</ul>
<h3 id="fuctions-for-subsetting-of-for-justapposing-math-objects">Fuctions for subsetting of for justapposing <code>MatH</code> objects</h3>
<ul>
<li><code>WH.bind(MAT1, MAT2, byrow=TRUE)</code> attaches MAT2 on the right of MAT1. Naturally, the two <code>MatH</code> objects must have the same number of rows;<br>
</li>
<li><code>WH.bind(MAT1, MAT2, byrow=FALSE)</code> attaches MAT2 under MAT1. Naturally, the two <code>MatH</code> objects must have the same number of colums;<br>
</li>
<li><code>[,]</code> an overloaded method for subsetting a matrix. It returns a new <code>MatH</code> object.</li>
</ul>
</section>
<section id="subsetting-example" class="slide level2">
<h2>Subsetting example</h2>
<h3 id="section-1"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="" aria-hidden="true" tabindex="-1"></a>BLOOD[<span class="dv">10</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] </span>
<span id="cb29-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## a matrix of distributions </span></span>
<span id="cb29-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##  2  variables  5  rows </span></span>
<span id="cb29-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##  each distibution in the cell is represented by the mean and the standard deviation </span></span>
<span id="cb29-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Cholesterol               Hemoglobin        </span></span>
<span id="cb29-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u10: M-40 [m= 170.06  ,s= 20.011 ]  [m= 12.092  ,s= 0.52656 ]</span></span>
<span id="cb29-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u11: M-50 [m= 194.22  ,s= 30.165 ]  [m= 12.214  ,s= 0.59708 ]</span></span>
<span id="cb29-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u12: M-60 [m= 203.36  ,s= 26.223 ]  [m= 12.245  ,s= 0.50862 ]</span></span>
<span id="cb29-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u13: M-70 [m= 205.66  ,s= 22.499 ]  [m= 12.15  ,s= 0.33425 ] </span></span>
<span id="cb29-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u14: M-80+ [m= 205.48  ,s= 23.537 ]   [m= 12.12  ,s= 0.6163 ]</span></span>
<span id="cb29-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="" aria-hidden="true" tabindex="-1"></a>BLOOD[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co">#ATTENTION: returns a 1x1 MatH, and not a distributionH</span></span>
<span id="cb29-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## a matrix of distributions </span></span>
<span id="cb29-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  variables  1  rows </span></span>
<span id="cb29-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##  each distibution in the cell is represented by the mean and the standard deviation </span></span>
<span id="cb29-16"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##                  Hematocrit       </span></span>
<span id="cb29-17"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## u2: F-30 [m= 36.497  ,s= 2.1225 ]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extracting-a-distributionh-from-a-math-how-to-do-it" class="slide level2">
<h2>Extracting a <code>distributionH</code> from a <code>MatH</code>: how to do it?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of BLOOD[2,3]</span></span>
<span id="cb30-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># you must use </span></span>
<span id="cb30-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="" aria-hidden="true" tabindex="-1"></a>BLOOD<span class="sc">@</span>M[<span class="dv">2</span>,<span class="dv">3</span>][[<span class="dv">1</span>]] <span class="co">#Not attractive, it needs improvements! </span></span>
<span id="cb30-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##               X             p</span></span>
<span id="cb30-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_1   [ 31 ; 33 )         0.046</span></span>
<span id="cb30-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_2   [ 33 ; 35 )         0.171</span></span>
<span id="cb30-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_3 [ 35 ; 36.5 )         0.295</span></span>
<span id="cb30-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_4 [ 36.5 ; 38 )         0.243</span></span>
<span id="cb30-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_5 [ 38 ; 39.5 )          0.17</span></span>
<span id="cb30-11"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_6 [ 39.5 ; 41 )         0.072</span></span>
<span id="cb30-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Bin_7   [ 41 ; 44 ]         0.003</span></span>
<span id="cb30-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##  mean =  36.497   std  =  2.12245714522903 </span></span>
<span id="cb30-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="matrix-operation-between-math-objects" class="slide level2">
<h2>Matrix operation between <code>MatH</code> objects</h2>
<h3 id="methods-based-on-l_2-wasserstein-norm-for-summing-and-multiplying-matrices">Methods based on <span class="math inline">\(L_2\)</span> Wasserstein norm for summing and multiplying matrices</h3>
<div style="font-size: 0.85em">
<ul>
<li><code>WH.mat.sum</code> performs a classic cell by cell sum. In particular, the result is a new <code>MatH</code> object having in each cell a distribution associated with the quantile function resulting from the sum of the corresponding quantile functions (It is a sum consistent with the Wasserstein metric). As usual, the matrix must have the same dimensions.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="" aria-hidden="true" tabindex="-1"></a>MAT.sum <span class="ot">&lt;-</span> <span class="fu">WH.mat.sum</span>(MyMAT1,MyMAT2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>WH.mat.prod</code> performs the matrix multiplication of two <code>MatH</code> objects. It returns a <strong>matrix of numbers</strong> according to the dot product defined for two distributions and associated with the <span class="math inline">\(L_2\)</span> Wasserstein metric. It is possible also to consider trasposition of matrices.</li>
</ul>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="" aria-hidden="true" tabindex="-1"></a>MAT.prod <span class="ot">&lt;-</span> <span class="fu">WH.mat.prod</span>(MyMAT1,MyMAT2, <span class="at">traspose1=</span><span class="cn">FALSE</span>, <span class="at">traspose2=</span><span class="cn">FALSE</span>)</span>
<span id="cb32-2"><a href="" aria-hidden="true" tabindex="-1"></a>MAT.prod <span class="ot">&lt;-</span> <span class="fu">WH.mat.prod</span>(MyMAT1,MyMAT2, <span class="at">traspose1=</span><span class="cn">TRUE</span>, <span class="at">traspose2=</span><span class="cn">FALSE</span>)</span>
<span id="cb32-3"><a href="" aria-hidden="true" tabindex="-1"></a>MAT.prod <span class="ot">&lt;-</span> <span class="fu">WH.mat.prod</span>(MyMAT1,MyMAT2, <span class="at">traspose1=</span><span class="cn">FALSE</span>, <span class="at">traspose2=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="methods-for-univariate-and-bivariate-statistics-of-histogram-variables-the-mean-distribution" class="slide level2">
<h2>Methods for univariate and bivariate statistics of histogram variables: the mean distribution</h2>
<ul>
<li><code>WH.vec.mean</code> computes a <code>distributionH</code> that is the mean distribution of a vector or a matrix of distributions (a <code>MatH</code> object). The mean distribution is computed accordingly to the sum based on the <span class="math inline">\(L_2\)</span> Wasserstein distance, namely, it is the distribution associated with the average <em>quantile function</em> of the <em>quantile functions</em> of the vector of distributions. It is possible also to assign weights to the elements of vetor in order to obtain a weighted mean.<br>
</li>
<li><code>WH.vec.sum</code> same as <code>WH.vec.mean</code>, but computes only the sum.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WH.vec.mean</span>(BLOOD[,<span class="dv">1</span>]) <span class="co">#returns the average distribution of </span></span>
<span id="cb33-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># the first variable</span></span>
<span id="cb33-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WH.vec.mean</span>(BLOOD[,<span class="dv">1</span>], <span class="at">w =</span> <span class="fu">runif</span>(<span class="fu">get.MatH.nrows</span>(MyMAT)))</span>
<span id="cb33-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a random weighted average</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-graphic-example-of-wh.vec.mean" class="slide level2">
<h2>A graphic example of <code>WH.vec.mean</code></h2>

<img data-src="figures/Mean_BLOOD.png" class="r-stretch"></section>
<section id="methods-for-univariate-and-bivariate-statistics-of-histogram-variables-variability-and-association-measures" class="slide level2">
<h2>Methods for univariate and bivariate statistics of histogram variables: <br> variability and association measures</h2>
<div style="font-size: 0.85em">
<p>These methods returns a matrix of numbers accordingly to the number of the compared variables. The formulas are those presented in <span class="citation" data-cites="IrpVer2015">(<a href="#/references" role="doc-biblioref" onclick="">Irpino and Verde 2015</a>)</span>.</p>
<h3 id="sum-of-squares"><strong>Sum of squares</strong></h3>
<ul>
<li><strong><code>WH.SSQ(MyMAT, w=w)</code></strong> computes the weighted Sum of Squares and the Sum of products of the deviations from the means of a <code>MatH</code> object. The weights are associated to the rows, if missing, the weights are considered equal. The result is square matrix of dimension equal to the number of variables of the <code>MatH</code> object.</li>
<li><strong><code>WH.SSQ2(MyMAT1, MyMAT2, w=w)</code></strong> computes the weighted Sum of products of the deviations from the means of two <code>MatH</code> objects. The two matrices must have the same number of rows. The result is rectangular matrix with rows equal to the number of variables of the first <code>MatH</code> object and columns the number of variables of the first <code>MatH</code> object.</li>
</ul>
<p>Using these functions, it is possible to compute covariances and correlations.</p>
</div>
</section>
<section id="covariance-and-correlation-measures" class="slide level2">
<h2>Covariance and correlation measures</h2>
<h3 id="variance-covariance-and-correlation"><strong>Variance, covariance and correlation</strong></h3>
<ul>
<li><strong><code>WH.var.covar(MyMAT, w=w)</code></strong> computes the variance-covariance matrix of a <code>MatH</code> object.</li>
<li><strong><code>WH.var.covar2(MyMAT1, MyMAT2, w=w)</code></strong> computes a covariance matrix between two <code>MatH</code> objects.</li>
<li><strong><code>WH.correlation(MyMAT, w=w)</code></strong> computes the correlation matrix of a <code>MatH</code> object.</li>
<li><strong><code>WH.correlation2(MyMAT1, MyMAT2, w=w)</code></strong> computes the correlation matrix of two <code>MatH</code> objects.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WH.var.covar</span>(BLOOD)</span>
<span id="cb34-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##             Cholesterol Hemoglobin  Hematocrit</span></span>
<span id="cb34-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Cholesterol  388.137633 -5.0005134 -14.9202378</span></span>
<span id="cb34-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Hemoglobin    -5.000513  0.2802215   0.8266558</span></span>
<span id="cb34-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Hematocrit   -14.920238  0.8266558   2.9779786</span></span>
<span id="cb34-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">WH.correlation</span>(BLOOD)</span>
<span id="cb34-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##             Cholesterol Hemoglobin Hematocrit</span></span>
<span id="cb34-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Cholesterol   1.0000000 -0.4794806 -0.4388560</span></span>
<span id="cb34-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Hemoglobin   -0.4794806  1.0000000  0.9049264</span></span>
<span id="cb34-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Hematocrit   -0.4388560  0.9049264  1.0000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="examples-of-how-to-compute-basic-statistics-of-variability-for-a-single-variable" class="slide level2">
<h2>Examples of how to compute basic statistics of variability for a single variable</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># the variance of a histogram variable</span></span>
<span id="cb35-2"><a href="" aria-hidden="true" tabindex="-1"></a>VAR.Choresterol<span class="ot">=</span><span class="fu">WH.var.covar</span>(BLOOD[,<span class="dv">1</span>])</span>
<span id="cb35-3"><a href="" aria-hidden="true" tabindex="-1"></a>VAR.Choresterol</span>
<span id="cb35-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##             Cholesterol</span></span>
<span id="cb35-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Cholesterol    388.1376</span></span>
<span id="cb35-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># the standard deviation</span></span>
<span id="cb35-7"><a href="" aria-hidden="true" tabindex="-1"></a>STD.Choresterol<span class="ot">=</span><span class="fu">sqrt</span>(VAR.Choresterol)</span>
<span id="cb35-8"><a href="" aria-hidden="true" tabindex="-1"></a>STD.Choresterol</span>
<span id="cb35-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">##             Cholesterol</span></span>
<span id="cb35-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="do">## Cholesterol    19.70121</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analysis-methods-implemented-in-histdawass" class="slide level2">
<h2>Analysis methods implemented in <code>HistDAWass</code></h2>

<img data-src="figures/HistDAWass2.svg" class="r-stretch"></section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li><code>HistDAWass</code> package for the analysis of histogram data tables</li>
<li>Histograms may not share the same binning</li>
<li>Provides classes for single histograms and tables of histograms</li>
<li>Provides a set of exploratory data analysis tools based on Wasserstein distance</li>
<li>Can be easily extended starting from the basic classes</li>
<li>Contains several histogram datasets (see the help of the package)</li>
<li>Examples of analysis in <span style="color: yellow;"> <a href="2022"><span class="citation" data-cites="DDA_2022">Brito and Dias (<span>2022</span>)</span></a>. Analysis of Distributional Data (1st ed.). Chapman and Hall/CRC. https://doi.org/10.1201/9781315370545</span></li>
<li>github with examples <a href="https://github.com/Airpino/Clustering_DD_app" class="uri">https://github.com/Airpino/Clustering_DD_app</a></li>
</ul>
</section>
<section id="future-developments" class="slide level2">
<h2>Future developments</h2>
<div style="font-size: 0.85em">
<ul>
<li>We are developing a new suite called <code>wassdda</code> (Distributional data analysis using Wasserstein distance)</li>
<li>New classes:
<ul>
<li>1-d new objects
<ul>
<li>discrete 1-d distributions (barcharts)</li>
<li>continuous 1-d distributions (using kernel density estimation)</li>
</ul></li>
<li>Tables of
<ul>
<li>Histogram variables</li>
<li>Discrete distributional variables</li>
<li>Continuous distributional variables</li>
</ul></li>
</ul></li>
<li>New re-factored methods for considering the different types of distributional variables</li>
<li>New methods of analysis (not necessarily related to Wasserstein distance only)</li>
</ul>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-DDA_2022" class="csl-entry" role="listitem">
Brito, P., and S. Dias. 2022. <em>Analysis of Distributional Data</em>. Chapman; Hall,CRC. <a href="https://doi.org/10.1201/9781315370545">https://doi.org/10.1201/9781315370545</a>.
</div>
<div id="ref-Gilch2000" class="csl-entry" role="listitem">
Gilchrist, Warren. 2000. <em>Statistical Modelling with Quantile Functions</em>. Abingdon: CRC Press.
</div>
<div id="ref-DBLP:conf/f-egc/2007" class="csl-entry" role="listitem">
Irpino, Antonio, and Elvira Romano. 2007. <span>“Optimal Histogram Representation of Large Data Sets: Fisher Vs Piecewise Linear Approximation.”</span> In <em>EGC</em>, edited by Monique Noirhomme-Fraiture and Gilles Venturini, RNTI-E-9:99–110. Revue Des Nouvelles Technologies de l’information. C<span>é</span>padu<span>è</span>s-<span>É</span>ditions.
</div>
<div id="ref-IrpVer2015" class="csl-entry" role="listitem">
Irpino, Antonio, and Rosanna Verde. 2015. <span>“Basic Statistics for Distributional Symbolic Variables: A New Metric-Based Approach.”</span> <em>Advances in Data Analysis and Classification</em> 9 (2): 143–75. <a href="https://doi.org/10.1007/s11634-014-0176-4">https://doi.org/10.1007/s11634-014-0176-4</a>.
</div>
</div>
</section>
<section id="questions-answers" class="slide level2">
<h2>Questions &amp; Answers</h2>
<div style="text-align: center; font-size: 2em; margin-top: 1em;">
<p>Thank you for your attention!<br> Feel free to ask any questions.</p>
</div>
<div class="columns">
<div class="column">
<p><strong>Antonio Irpino</strong><br>
<em>Department of Mathematics and Physics</em><br>
<em>University of Campania “L. Vanvitelli”</em> <a href="mailto:antonio.irpino@unicampania.it" class="email">antonio.irpino@unicampania.it</a></p>
</div><div class="column">
<p><img data-src="figures/Irpino.jpg"></p>
</div></div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="sda_logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>A. Irpino - SDA workshop, — Varaždin, Croatia — 9–11 June 2025</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="pre_new_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="pre_new_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="pre_new_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="pre_new_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script type="text/javascript" charset="utf-8">

      function add_custom_footer() {

        let title_slide = document.querySelector("section#title-slide");

        let title_slide_footer = title_slide.getAttribute('data-footer');

        let footer = document.querySelector('div.footer p');

        let global_footer_text = footer.innerHTML;

        

        if (title_slide.classList.contains('present')) {

          footer.innerHTML = title_slide_footer;

        }

        

        Reveal.on( 'slidechanged' , event => {

            if (event.currentSlide.matches('#title-slide')) {

              footer.innerHTML = title_slide_footer;

            } else {

              footer.innerHTML = global_footer_text;

            }

          });

      };

      

      window.addEventListener("load", (event) => {

        add_custom_footer();

      });

    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>